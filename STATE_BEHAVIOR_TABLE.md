# PomodoroScreen çŠ¶æ€è¡Œä¸ºè¡¨

## ðŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è®°å½•äº† PomodoroScreen åº”ç”¨åœ¨ä¸åŒçŠ¶æ€ä¸‹çš„è¡Œä¸ºè¡¨çŽ°ï¼ŒåŒ…æ‹¬èœå•æ˜¾ç¤ºã€è®¾ç½®å¤„ç†ã€è‡ªåŠ¨å¯åŠ¨ç­‰åŠŸèƒ½çš„å…·ä½“è¡Œä¸ºã€‚

## ðŸ” çŠ¶æ€å±žæ€§è¯´æ˜Ž

### æ ¸å¿ƒçŠ¶æ€å±žæ€§

| å±žæ€§ | ç±»åž‹ | æè¿° |
|------|------|------|
| `isRunning` | `Bool` | è®¡æ—¶å™¨æ˜¯å¦æ­£åœ¨è¿è¡Œï¼ˆ`timer != nil && !isPaused`ï¼‰ |
| `isPausedState` | `Bool` | è®¡æ—¶å™¨æ˜¯å¦å¤„äºŽæš‚åœçŠ¶æ€ï¼ˆä¼ ç»Ÿæš‚åœé€»è¾‘ï¼‰ |
| `canResume` | `Bool` | è®¡æ—¶å™¨æ˜¯å¦å¯ä»¥ç»§ç»­ï¼ˆåŒ…æ‹¬æš‚åœå’Œåœæ­¢ä½†æœªé‡ç½®çŠ¶æ€ï¼‰ |

### çŠ¶æ€æœºçŠ¶æ€

| çŠ¶æ€æœºçŠ¶æ€ | æè¿° |
|------------|------|
| `.idle` | ç©ºé—²çŠ¶æ€ï¼Œç­‰å¾…äº‹ä»¶ |
| `.timerRunning` | è®¡æ—¶å™¨è¿è¡Œä¸­ |
| `.timerPausedByIdle` | å› æ— æ“ä½œè€Œæš‚åœ |
| `.timerPausedBySystem` | å› ç³»ç»Ÿäº‹ä»¶ï¼ˆé”å±ã€å±ä¿ï¼‰è€Œæš‚åœ |
| `.awaitingRestart` | ç­‰å¾…é‡æ–°å¯åŠ¨ |
| `.restPeriod` | ä¼‘æ¯æœŸé—´ |
| `.restTimerRunning` | ä¼‘æ¯è®¡æ—¶å™¨è¿è¡Œä¸­ |
| `.restTimerPausedBySystem` | ä¼‘æ¯è®¡æ—¶å™¨å› ç³»ç»Ÿäº‹ä»¶æš‚åœ |

## ðŸ“Š å®Œæ•´çŠ¶æ€è¡Œä¸ºè¡¨

| åœºæ™¯ | çŠ¶æ€æœºçŠ¶æ€ | `isRunning` | `isPausedState` | `canResume` | èœå•æ˜¾ç¤º | è®¾ç½®é‡ç½®å‰©ä½™æ—¶é—´ | è‡ªåŠ¨å¯åŠ¨ | å¤‡æ³¨ |
|------|------------|-------------|-----------------|-------------|----------|------------------|----------|------|
| **å…¨æ–°å¯åŠ¨** | `.idle` | `false` | `false` | `false` | "å¼€å§‹" | âœ… æ˜¯ | âœ… æ˜¯ | `remainingTime == getTotalTime()` |
| **è®¡æ—¶å™¨è¿è¡Œä¸­** | `.timerRunning` | `true` | `false` | `false` | "åœæ­¢" | âŒ å¦ | âŒ å¦ | æ­£å¸¸è®¡æ—¶çŠ¶æ€ |
| **æ‰‹åŠ¨æš‚åœ** | `.timerPausedBySystem` | `false` | `true` | `true` | "ç»§ç»­" | âŒ å¦ | âŒ å¦ | ç”¨æˆ·ä¸»åŠ¨æš‚åœ |
| **æ— æ“ä½œæš‚åœ** | `.timerPausedByIdle` | `false` | `true` | `true` | "ç»§ç»­" | âŒ å¦ | âŒ å¦ | ç³»ç»Ÿæ£€æµ‹åˆ°æ— æ“ä½œ |
| **é”å±æš‚åœ** | `.timerPausedBySystem` | `false` | `true` | `true` | "ç»§ç»­" | âŒ å¦ | âŒ å¦ | å±å¹•é”å®šè§¦å‘ |
| **å±ä¿æš‚åœ** | `.timerPausedBySystem` | `false` | `true` | `true` | "ç»§ç»­" | âŒ å¦ | âŒ å¦ | å±ä¿å¯åŠ¨è§¦å‘ |
| **ç”¨æˆ·åœæ­¢** | `.idle` | `false` | `false` | `true` | "ç»§ç»­" | âŒ å¦ | âŒ å¦ | `remainingTime > 0 && remainingTime < getTotalTime()` - ä¼˜åŒ–åŽ |
| **é‡ç½®åŽ** | `.idle` | `false` | `false` | `false` | "å¼€å§‹" | âœ… æ˜¯ | âœ… æ˜¯ | `remainingTime == getTotalTime()` |
| **ä¼‘æ¯æœŸé—´** | `.restPeriod` | `false` | `false` | `false` | "å¼€å§‹" | âœ… æ˜¯ | âœ… æ˜¯ | ç­‰å¾…ç”¨æˆ·å¼€å§‹ä¼‘æ¯ |
| **ä¼‘æ¯è®¡æ—¶ä¸­** | `.restTimerRunning` | `true` | `false` | `false` | "åœæ­¢" | âŒ å¦ | âŒ å¦ | ä¼‘æ¯è®¡æ—¶å™¨è¿è¡Œ |

## ðŸš€ çŠ¶æ€ä¼˜åŒ–æ€»ç»“ (v1.0.1)

### ä¼˜åŒ–ç›®æ ‡
è§£å†³ç”¨æˆ·åœæ­¢è®¡æ—¶å™¨åŽèœå•æ˜¾ç¤ºå’Œè®¾ç½®è¡Œä¸ºçš„ä¸ä¸€è‡´é—®é¢˜ã€‚

### ä¸»è¦æ”¹è¿›

#### 1. èœå•æ˜¾ç¤ºé€»è¾‘ä¼˜åŒ–
- **é—®é¢˜**: ç”¨æˆ·åœæ­¢åŽèœå•æ˜¾ç¤º"å¼€å§‹"ï¼Œä½†ç”¨æˆ·æœŸæœ›"ç»§ç»­"
- **è§£å†³**: å¼•å…¥ `canResume` å±žæ€§ï¼ŒåŒºåˆ†"å®Œå…¨ç©ºé—²"å’Œ"åœæ­¢ä½†å¯ç»§ç»­"çŠ¶æ€
- **ç»“æžœ**: åœæ­¢åŽèœå•æ­£ç¡®æ˜¾ç¤º"ç»§ç»­"

#### 2. è®¾ç½®æ›´æ–°è¡Œä¸ºä¼˜åŒ–  
- **é—®é¢˜**: ç”¨æˆ·åœæ­¢åŽä¿®æ”¹è®¾ç½®ä¼šé‡ç½®å‰©ä½™æ—¶é—´ï¼Œä¸ç¬¦åˆé¢„æœŸ
- **è§£å†³**: ä¿®æ”¹è®¾ç½®æ›´æ–°é€»è¾‘ï¼Œä½¿ç”¨ `canResume` åˆ¤æ–­æ˜¯å¦ä¿ç•™è¿›åº¦
- **ç»“æžœ**: åœæ­¢çŠ¶æ€ä¸‹è®¾ç½®æ›´æ”¹ä¸ä¼šä¸¢å¤±è®¡æ—¶è¿›åº¦

#### 3. ä»£ç å¯è¯»æ€§æå‡
- **æ”¹è¿›**: æ·»åŠ è¯¦ç»†çš„çŠ¶æ€æ³¨é‡Šå’Œæ–‡æ¡£
- **ç»“æžœ**: çŠ¶æ€é€»è¾‘æ›´æ¸…æ™°ï¼Œä¾¿äºŽç»´æŠ¤å’Œæ‰©å±•

### ä¼˜åŒ–å‰åŽå¯¹æ¯”

| åœºæ™¯ | ä¼˜åŒ–å‰èœå• | ä¼˜åŒ–åŽèœå• | ä¼˜åŒ–å‰è®¾ç½®è¡Œä¸º | ä¼˜åŒ–åŽè®¾ç½®è¡Œä¸º |
|------|-----------|-----------|---------------|---------------|
| ç”¨æˆ·åœæ­¢ | "å¼€å§‹" âŒ | "ç»§ç»­" âœ… | é‡ç½®å‰©ä½™æ—¶é—´ âŒ | ä¿ç•™å‰©ä½™æ—¶é—´ âœ… |
| å…¨æ–°å¯åŠ¨ | "å¼€å§‹" âœ… | "å¼€å§‹" âœ… | é‡ç½®ä¸ºæ–°æ—¶é—´ âœ… | é‡ç½®ä¸ºæ–°æ—¶é—´ âœ… |
| æš‚åœçŠ¶æ€ | "ç»§ç»­" âœ… | "ç»§ç»­" âœ… | ä¿ç•™å‰©ä½™æ—¶é—´ âœ… | ä¿ç•™å‰©ä½™æ—¶é—´ âœ… |

## ðŸŽ¯ å…³é”®é€»è¾‘è¯´æ˜Ž

### 1. `isPausedState` åˆ¤æ–­é€»è¾‘

```swift
var isPausedState: Bool {
    let currentState = autoRestartStateMachine.getCurrentState()
    
    // å¦‚æžœæ‰‹åŠ¨æš‚åœæˆ–ç³»ç»Ÿæš‚åœï¼Œè¿”å›žtrue
    if isPaused || currentState == .timerPausedByIdle || currentState == .timerPausedBySystem {
        return true
    }
    
    return false
}
```

**è§¦å‘æ¡ä»¶**ï¼š
- `isPaused == true` (æ‰‹åŠ¨æš‚åœ)
- çŠ¶æ€æœºå¤„äºŽ `.timerPausedByIdle` (æ— æ“ä½œæš‚åœ)
- çŠ¶æ€æœºå¤„äºŽ `.timerPausedBySystem` (ç³»ç»Ÿäº‹ä»¶æš‚åœ)

### 2. `canResume` åˆ¤æ–­é€»è¾‘

```swift
var canResume: Bool {
    // ä¼ ç»Ÿæš‚åœçŠ¶æ€
    if isPausedState {
        return true
    }
    
    // åœæ­¢ä½†æœªé‡ç½®çŠ¶æ€ï¼ˆidleçŠ¶æ€ä¸‹æœ‰å‰©ä½™æ—¶é—´ï¼‰
    let currentState = autoRestartStateMachine.getCurrentState()
    if currentState == .idle && remainingTime > 0 && remainingTime < getTotalTime() {
        return true
    }
    
    return false
}
```

**è§¦å‘æ¡ä»¶**ï¼š
- æ»¡è¶³ `isPausedState` çš„æ‰€æœ‰æ¡ä»¶
- **æˆ–è€…** çŠ¶æ€æœºå¤„äºŽ `.idle` ä¸” `remainingTime > 0` ä¸” `remainingTime < getTotalTime()`

### 3. èœå•æ˜¾ç¤ºé€»è¾‘

```swift
if pomodoroTimer.isRunning {
    // è®¡æ—¶å™¨æ­£åœ¨è¿è¡Œ - æ˜¾ç¤º"åœæ­¢"
    title = "åœæ­¢"
    action = #selector(stopTimer)
} else if pomodoroTimer.canResume {
    // è®¡æ—¶å™¨å¯ä»¥ç»§ç»­ï¼ˆæš‚åœæˆ–åœæ­¢ä½†æœªé‡ç½®ï¼‰ - æ˜¾ç¤º"ç»§ç»­"
    title = "ç»§ç»­"
    action = #selector(startTimer)
} else {
    // è®¡æ—¶å™¨æœªè¿è¡Œä¸”ä¸å¯ç»§ç»­ - æ˜¾ç¤º"å¼€å§‹"
    title = "å¼€å§‹"
    action = #selector(startTimer)
}
```

## ðŸ”„ çŠ¶æ€è½¬æ¢æµç¨‹

### æ­£å¸¸ä½¿ç”¨æµç¨‹

```
å…¨æ–°å¯åŠ¨ â†’ å¼€å§‹è®¡æ—¶ â†’ è¿è¡Œä¸­ â†’ åœæ­¢ â†’ å¯ç»§ç»­ â†’ ç»§ç»­è®¡æ—¶ â†’ è¿è¡Œä¸­
   â†“                                    â†“
 "å¼€å§‹"                               "ç»§ç»­"
```

### æš‚åœæ¢å¤æµç¨‹

```
è¿è¡Œä¸­ â†’ ç³»ç»Ÿæš‚åœ â†’ æš‚åœçŠ¶æ€ â†’ æ¢å¤ â†’ è¿è¡Œä¸­
         (é”å±/å±ä¿/æ— æ“ä½œ)
            â†“
          "ç»§ç»­"
```

### é‡ç½®æµç¨‹

```
ä»»æ„çŠ¶æ€ â†’ é‡ç½® â†’ å…¨æ–°å¯åŠ¨
                   â†“
                 "å¼€å§‹"
```

## âš™ï¸ è®¾ç½®æ›´æ–°è¡Œä¸º

### å‰©ä½™æ—¶é—´æ›´æ–°è§„åˆ™

| æ¡ä»¶ | è¡Œä¸º | è¯´æ˜Ž |
|------|------|------|
| `!isRunning && !isPausedState` | æ›´æ–°ä¸ºæ–°çš„ç•ªèŒ„é’Ÿæ—¶é—´ | ç©ºé—²çŠ¶æ€ï¼Œå…è®¸é‡ç½® |
| `isRunning \|\| isPausedState` | ä¿æŒå½“å‰å‰©ä½™æ—¶é—´ | æ´»è·ƒçŠ¶æ€ï¼Œä¿æŒè¿›åº¦ |

**æ³¨æ„**ï¼šç”¨æˆ·åœæ­¢çŠ¶æ€ä¸‹ï¼Œç”±äºŽ `isPausedState == false`ï¼Œè®¾ç½®æ›´æ”¹ä¼šé‡ç½®å‰©ä½™æ—¶é—´ã€‚

### è‡ªåŠ¨å¯åŠ¨è§„åˆ™

```swift
if autoStart && !wasRunning && !wasPaused {
    startTimer() // åªæœ‰å®Œå…¨ç©ºé—²æ—¶æ‰è‡ªåŠ¨å¯åŠ¨
}
```

**è§¦å‘æ¡ä»¶**ï¼š
- å¯ç”¨è‡ªåŠ¨å¯åŠ¨
- è®¡æ—¶å™¨æœªè¿è¡Œ (`!wasRunning`)
- è®¡æ—¶å™¨æœªæš‚åœ (`!wasPaused`)

## ðŸ§ª æµ‹è¯•åœºæ™¯

### åŸºæœ¬åŠŸèƒ½æµ‹è¯•

1. **å¯åŠ¨ â†’ åœæ­¢ â†’ ç»§ç»­**
   - éªŒè¯èœå•æ–‡å­—æ­£ç¡®æ˜¾ç¤º
   - éªŒè¯å‰©ä½™æ—¶é—´ä¿æŒ

2. **å¯åŠ¨ â†’ æš‚åœ â†’ ç»§ç»­**
   - éªŒè¯ç³»ç»Ÿæš‚åœæœºåˆ¶
   - éªŒè¯æ¢å¤åŽçŠ¶æ€æ­£ç¡®

3. **åœæ­¢ â†’ è®¾ç½®æ›´æ”¹ â†’ é‡ç½®ç¡®è®¤**
   - éªŒè¯è®¾ç½®æ›´æ”¹é‡ç½®å‰©ä½™æ—¶é—´
   - éªŒè¯èœå•æ˜¾ç¤ºå›žåˆ°"å¼€å§‹"

### è¾¹ç•Œæ¡ä»¶æµ‹è¯•

1. **å‰©ä½™æ—¶é—´ä¸º0æ—¶çš„è¡Œä¸º**
2. **çŠ¶æ€æœºå¼‚å¸¸çŠ¶æ€çš„å¤„ç†**
3. **å¿«é€ŸçŠ¶æ€åˆ‡æ¢çš„ç¨³å®šæ€§**

## ðŸ“ è®¾è®¡åŽŸåˆ™

### 1. å…³æ³¨ç‚¹åˆ†ç¦»
- `isPausedState`ï¼šä¼ ç»Ÿæš‚åœé€»è¾‘ï¼Œç”¨äºŽè®¾ç½®å’Œè‡ªåŠ¨å¯åŠ¨
- `canResume`ï¼šUIæ˜¾ç¤ºé€»è¾‘ï¼Œç”¨äºŽèœå•æ–‡å­—åˆ¤æ–­

### 2. å‘åŽå…¼å®¹
- ä¿æŒçŽ°æœ‰ `isPausedState` çš„è¯­ä¹‰ä¸å˜
- ä¸å½±å“çŽ°æœ‰åŠŸèƒ½å’Œæµ‹è¯•ç”¨ä¾‹

### 3. ç”¨æˆ·ä½“éªŒä¼˜å…ˆ
- åœæ­¢åŽæ˜¾ç¤º"ç»§ç»­"è€Œä¸æ˜¯"å¼€å§‹"
- ä¿æŒè®¾ç½®æ›´æ–°çš„çµæ´»æ€§

## ðŸ”§ ç»´æŠ¤æ³¨æ„äº‹é¡¹

1. **çŠ¶æ€ä¸€è‡´æ€§**ï¼šç¡®ä¿çŠ¶æ€æœºçŠ¶æ€ä¸Žè®¡æ—¶å™¨çŠ¶æ€ä¿æŒåŒæ­¥
2. **æµ‹è¯•è¦†ç›–**ï¼šæ–°å¢žçŠ¶æ€éœ€è¦ç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹
3. **æ–‡æ¡£æ›´æ–°**ï¼šçŠ¶æ€å˜æ›´æ—¶åŠæ—¶æ›´æ–°æ­¤æ–‡æ¡£

---

*æœ€åŽæ›´æ–°ï¼š2025å¹´9æœˆ22æ—¥*  
*ç‰ˆæœ¬ï¼šv1.0.0*
